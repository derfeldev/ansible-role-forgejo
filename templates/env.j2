# SPDX-FileCopyrightText: 2025 Pavel Dimov <@sagat79>
#
# SPDX-License-Identifier: CC0-1.0

FORGEJO__server__ROOT_URL={{ forgejo_config_root_url }}

FORGEJO__server__SSH_LISTEN_PORT=2222

# Logging configuration
FORGEJO__log__LEVEL={{ forgejo_config_log_level }}
FORGEJO__log__MODE={{ forgejo_config_log_mode }}
{% if forgejo_config_log_file_path %}
FORGEJO__log__FILE={{ forgejo_config_log_file_path }}
{% endif %}

FORGEJO__database__DB_TYPE={{ forgejo_config_database_type }}
FORGEJO__database__HOST={{ forgejo_config_database_hostname }}:{{ forgejo_config_database_port }}
FORGEJO__database__NAME={{ forgejo_config_database_name }}
FORGEJO__database__USER={{ forgejo_config_database_username }}
FORGEJO__database__PASSWD={{ forgejo_config_database_password }}
{% if forgejo_config_database_ssl_mode %}
FORGEJO__database__SSL_MODE={{ forgejo_config_database_ssl_mode }}
{% endif %}
{% if forgejo_config_database_ssl_ca %}
FORGEJO__database__SSL_CA={{ forgejo_config_database_ssl_ca }}
{% endif %}
{% if forgejo_config_database_ssl_cert %}
FORGEJO__database__SSL_CERT={{ forgejo_config_database_ssl_cert }}
{% endif %}
{% if forgejo_config_database_ssl_key %}
FORGEJO__database__SSL_KEY={{ forgejo_config_database_ssl_key }}
{% endif %}

FORGEJO____RUN_USER={{ forgejo_config_run_user }}

# Security settings
{% if forgejo_config_security_install_lock %}
FORGEJO__security__INSTALL_LOCK={{ forgejo_config_security_install_lock | lower }}
{% endif %}
{% if forgejo_config_security_secret_key %}
FORGEJO__security__SECRET_KEY={{ forgejo_config_security_secret_key }}
{% endif %}
{% if forgejo_config_security_internal_token %}
FORGEJO__security__INTERNAL_TOKEN={{ forgejo_config_security_internal_token }}
{% endif %}

# Mail settings
{% if forgejo_config_mail_enabled %}
FORGEJO__mailer__ENABLED={{ forgejo_config_mail_enabled | lower }}
FORGEJO__mailer__HOST={{ forgejo_config_mail_host }}
FORGEJO__mailer__PORT={{ forgejo_config_mail_port }}
{% if forgejo_config_mail_username %}
FORGEJO__mailer__USER={{ forgejo_config_mail_username }}
{% endif %}
{% if forgejo_config_mail_password %}
FORGEJO__mailer__PASSWD={{ forgejo_config_mail_password }}
{% endif %}
{% if forgejo_config_mail_from %}
FORGEJO__mailer__FROM={{ forgejo_config_mail_from }}
{% endif %}
FORGEJO__mailer__USE_TLS={{ forgejo_config_mail_use_tls | lower }}
FORGEJO__mailer__USE_SSL={{ forgejo_config_mail_use_ssl | lower }}
{% endif %}

# Performance and caching
FORGEJO__cache__ADAPTER={{ forgejo_config_cache_adapter }}
FORGEJO__cache__TTL={{ forgejo_config_cache_ttl }}
FORGEJO__session__PROVIDER={{ forgejo_config_session_provider }}
FORGEJO__session__PROVIDER_CONFIG={{ forgejo_config_session_config }}

# Repository settings
FORGEJO__repository__UPLOAD_MAX_SIZE={{ forgejo_config_repository_upload_max_size }}
{% if forgejo_config_repository_upload_allowed_types %}
FORGEJO__repository__UPLOAD_ALLOWED_TYPES={{ forgejo_config_repository_upload_allowed_types }}
{% endif %}
FORGEJO__repository__UPLOAD_MAX_FILES={{ forgejo_config_repository_upload_max_files }}

# Repository management
FORGEJO__repository__ENABLE_TIMETRACKING={{ forgejo_config_repository_enable_timetracking | lower }}
FORGEJO__repository__ENABLE_ISSUES={{ forgejo_config_repository_enable_issues | lower }}
FORGEJO__repository__ENABLE_PULLS={{ forgejo_config_repository_enable_pulls | lower }}
FORGEJO__repository__ENABLE_WIKI={{ forgejo_config_repository_enable_wiki | lower }}
FORGEJO__repository__ENABLE_EXTERNAL_TRACKER={{ forgejo_config_repository_enable_external_tracker | lower }}
FORGEJO__repository__ENABLE_EXTERNAL_WIKI={{ forgejo_config_repository_enable_external_wiki | lower }}

# Issue and pull request advanced settings
FORGEJO__issue__ENABLE_DEPENDENCIES={{ forgejo_config_issue_enable_dependencies | lower }}
FORGEJO__issue__ENABLE_TIME_TRACKING={{ forgejo_config_issue_enable_time_tracking | lower }}
FORGEJO__issue__ENABLE_TELEMETRY={{ forgejo_config_issue_enable_telemetry | lower }}
FORGEJO__issue__ENABLE_ASSIGNEE={{ forgejo_config_issue_enable_assignee | lower }}
FORGEJO__issue__ENABLE_LABELS={{ forgejo_config_issue_enable_labels | lower }}

# Issue and pull request settings
FORGEJO__issue__ENABLE_DEPENDENCIES={{ forgejo_config_issue_enable_dependencies | lower }}
FORGEJO__issue__ENABLE_TIME_TRACKING={{ forgejo_config_issue_enable_time_tracking | lower }}
FORGEJO__issue__ENABLE_TELEMETRY={{ forgejo_config_issue_enable_telemetry | lower }}

# Search and indexing
FORGEJO__search__ENABLED={{ forgejo_config_search_enabled | lower }}
FORGEJO__search__INDEXER_TYPE={{ forgejo_config_search_indexer_type }}
FORGEJO__search__MAX_INDEXER_WORKERS={{ forgejo_config_search_max_indexer_workers }}
FORGEJO__search__INDEXER_REPO_BATCH_SIZE={{ forgejo_config_search_indexer_repo_batch_size }}

# Attachment settings
FORGEJO__attachment__ENABLED={{ forgejo_config_attachment_enabled | lower }}
{% if forgejo_config_attachment_enabled %}
FORGEJO__attachment__PATH={{ forgejo_config_attachment_path }}
FORGEJO__attachment__MAX_SIZE={{ forgejo_config_attachment_max_size }}
{% if forgejo_config_attachment_allowed_types %}
FORGEJO__attachment__ALLOWED_TYPES={{ forgejo_config_attachment_allowed_types }}
{% endif %}
{% endif %}

# Mirror and federation
FORGEJO__mirror__ENABLED={{ forgejo_config_mirror_enabled | lower }}
FORGEJO__mirror__DEFAULT_INTERVAL={{ forgejo_config_mirror_default_interval }}
FORGEJO__mirror__MIN_INTERVAL={{ forgejo_config_mirror_min_interval }}
FORGEJO__federation__ENABLED={{ forgejo_config_federation_enabled | lower }}
FORGEJO__federation__SHARED_PUBLIC={{ forgejo_config_federation_shared_public | lower }}

# LFS (Large File Storage) settings
FORGEJO__lfs__ENABLED={{ forgejo_config_lfs_enabled | lower }}
{% if forgejo_config_lfs_enabled %}
FORGEJO__lfs__PATH={{ forgejo_config_lfs_path }}
FORGEJO__lfs__MAX_FILE_SIZE={{ forgejo_config_lfs_max_file_size }}
{% endif %}

# Admin and system settings
{% if forgejo_config_admin_contact_name %}
FORGEJO__admin__CONTACT_NAME={{ forgejo_config_admin_contact_name }}
{% endif %}
{% if forgejo_config_admin_contact_email %}
FORGEJO__admin__CONTACT_EMAIL={{ forgejo_config_admin_contact_email }}
{% endif %}
{% if forgejo_config_system_notice %}
FORGEJO__system__NOTICE={{ forgejo_config_system_notice | quote }}
{% endif %}
FORGEJO__system__NOTICE_LOGIN={{ forgejo_config_system_notice_login | lower }}
FORGEJO__system__NOTICE_LOGIN_ONLY={{ forgejo_config_system_notice_login_only | lower }}

# Time and locale settings
FORGEJO__time__FORMAT={{ forgejo_config_time_format | quote }}
FORGEJO__date__FORMAT={{ forgejo_config_date_format | quote }}
FORGEJO__ui__DEFAULT_LOCATION={{ forgejo_config_default_ui_location }}

# Security and monitoring
FORGEJO__security__DISABLE_GRAVATAR={{ forgejo_config_security_disable_gravatar | lower }}
FORGEJO__security__ENABLE_CAPTCHA={{ forgejo_config_security_enable_captcha | lower }}
{% if forgejo_config_security_enable_captcha %}
FORGEJO__security__CAPTCHA_TYPE={{ forgejo_config_security_captcha_type }}
{% if forgejo_config_security_captcha_type == 'recaptcha' %}
FORGEJO__security__CAPTCHA_RECAPTCHA_SECRET={{ forgejo_config_security_captcha_recaptcha_secret }}
FORGEJO__security__CAPTCHA_RECAPTCHA_SITE_KEY={{ forgejo_config_security_captcha_recaptcha_site_key }}
{% endif %}
{% endif %}

# Metrics and monitoring
FORGEJO__metrics__ENABLED={{ forgejo_config_metrics_enabled | lower }}
{% if forgejo_config_metrics_enabled and forgejo_config_metrics_token %}
FORGEJO__metrics__TOKEN={{ forgejo_config_metrics_token }}
{% endif %}

# Maintenance mode
{% if forgejo_maintenance_mode_enabled %}
FORGEJO__server__MAINTENANCE_MODE=true
FORGEJO__server__MAINTENANCE_MESSAGE={{ forgejo_maintenance_mode_message | quote }}
{% endif %}

# Backup and maintenance
FORGEJO__backup__AUTO_BACKUP={{ forgejo_config_backup_auto_backup_enabled | lower }}
{% if forgejo_config_backup_auto_backup_enabled %}
FORGEJO__backup__AUTO_BACKUP_RETENTION_DAYS={{ forgejo_config_backup_auto_backup_retention_days }}
FORGEJO__backup__AUTO_BACKUP_TIME={{ forgejo_config_backup_auto_backup_time | quote }}
FORGEJO__backup__AUTO_BACKUP_INCLUDE_ATTACHMENTS={{ forgejo_config_backup_auto_backup_include_attachments | lower }}
FORGEJO__backup__AUTO_BACKUP_INCLUDE_GIT_HOOKS={{ forgejo_config_backup_auto_backup_include_git_hooks | lower }}
FORGEJO__backup__AUTO_BACKUP_INCLUDE_LFS={{ forgejo_config_backup_auto_backup_include_lfs | lower }}
{% endif %}

# System maintenance
FORGEJO__maintenance__MODE_ENABLED={{ forgejo_config_maintenance_mode_enabled | lower }}
{% if forgejo_config_maintenance_mode_enabled %}
FORGEJO__maintenance__MODE_MESSAGE={{ forgejo_config_maintenance_mode_message | quote }}
FORGEJO__maintenance__MODE_ALLOW_WEBHOOKS={{ forgejo_config_maintenance_mode_allow_webhooks | lower }}
FORGEJO__maintenance__MODE_ALLOW_API={{ forgejo_config_maintenance_mode_allow_api | lower }}
{% endif %}

# Webhook configuration
{% if forgejo_config_webhook_allowed_host_list %}
FORGEJO__webhook__ALLOWED_HOST_LIST={{ forgejo_config_webhook_allowed_host_list }}
{% endif %}
FORGEJO__webhook__DELIVER_TIMEOUT={{ forgejo_config_webhook_deliver_timeout }}
FORGEJO__webhook__MAX_DELIVERIES={{ forgejo_config_webhook_max_deliveries }}

# Webhook advanced configuration
FORGEJO__webhook__SKIP_TLS_VERIFY={{ forgejo_config_webhook_skip_tls_verify | lower }}
FORGEJO__webhook__RETRY_AFTER={{ forgejo_config_webhook_retry_after }}

# API configuration
FORGEJO__api__ENABLED={{ forgejo_config_api_enabled | lower }}
FORGEJO__api__MAX_RESPONSE_ITEMS={{ forgejo_config_api_max_response_items }}
FORGEJO__api__DEFAULT_PAGING_NUM={{ forgejo_config_api_default_paging_num }}
FORGEJO__api__MAX_PAGING_NUM={{ forgejo_config_api_max_paging_num }}

# Integration settings
FORGEJO__integration__ENABLED={{ forgejo_config_integration_enabled | lower }}
FORGEJO__integration__WEBHOOK_ENABLED={{ forgejo_config_integration_webhook_enabled | lower }}
{% if forgejo_config_integration_webhook_secret %}
FORGEJO__integration__WEBHOOK_SECRET={{ forgejo_config_integration_webhook_secret }}
{% endif %}

# User and organization settings
FORGEJO__user__ENABLE_EMAIL_NOTIFICATION={{ forgejo_config_user_enable_email_notification | lower }}
FORGEJO__user__ENABLE_WEBHOOK_NOTIFICATION={{ forgejo_config_user_enable_webhook_notification | lower }}
FORGEJO__user__MAX_REPO_CREATION={{ forgejo_config_user_max_repo_creation }}
FORGEJO__user__MAX_CREATION={{ forgejo_config_user_max_creation }}

# Admin user configuration
{% if forgejo_config_admin_user_username %}
FORGEJO__admin__USERNAME={{ forgejo_config_admin_user_username }}
{% endif %}
{% if forgejo_config_admin_user_email %}
FORGEJO__admin__EMAIL={{ forgejo_config_admin_user_email }}
{% endif %}
{% if forgejo_config_admin_user_password %}
FORGEJO__admin__PASSWORD={{ forgejo_config_admin_user_password }}
{% endif %}

# Security and rate limiting
FORGEJO__security__LOGIN_REMEMBER_DAYS={{ forgejo_config_security_login_remember_days }}
FORGEJO__security__COOKIE_SECURE={{ forgejo_config_security_cookie_secure | lower }}
FORGEJO__security__COOKIE_HTTPONLY={{ forgejo_config_security_cookie_httponly | lower }}
FORGEJO__security__COOKIE_SAMESITE={{ forgejo_config_security_cookie_samesite }}

# Security and access control
FORGEJO__security__ENABLE_LOGIN_STATUS={{ forgejo_config_security_enable_login_status | lower }}
FORGEJO__security__ENABLE_LOGIN_SOURCE={{ forgejo_config_security_enable_login_source | lower }}
FORGEJO__security__ENABLE_REMEMBER_ME={{ forgejo_config_security_enable_remember_me | lower }}
FORGEJO__security__ENABLE_CAPTCHA={{ forgejo_config_security_enable_captcha | lower }}
FORGEJO__security__ENABLE_GRAVATAR={{ forgejo_config_security_enable_gravatar | lower }}

# User registration and access
FORGEJO__user__ENABLE_REGISTRATION={{ forgejo_config_user_enable_registration | lower }}
FORGEJO__user__ENABLE_CAPTCHA={{ forgejo_config_user_enable_captcha | lower }}
FORGEJO__user__ENABLE_EMAIL_CONFIRMATION={{ forgejo_config_user_enable_email_confirmation | lower }}
FORGEJO__user__ENABLE_REQUIRE_SIGNIN_VIEW={{ forgejo_config_user_enable_require_signin_view | lower }}

# Security and access control advanced settings
FORGEJO__security__ENABLE_2FA={{ forgejo_config_security_enable_2fa | lower }}
FORGEJO__security__ENABLE_OAUTH={{ forgejo_config_security_enable_oauth | lower }}
FORGEJO__security__ENABLE_LDAP={{ forgejo_config_security_enable_ldap | lower }}
FORGEJO__security__ENABLE_SAML={{ forgejo_config_security_enable_saml | lower }}

# Repository and issue management advanced settings
FORGEJO__repository__ENABLE_ACTIONS={{ forgejo_config_repository_enable_actions | lower }}
FORGEJO__repository__ENABLE_PACKAGES={{ forgejo_config_repository_enable_packages | lower }}
FORGEJO__repository__ENABLE_PROJECTS={{ forgejo_config_repository_enable_projects | lower }}
FORGEJO__repository__ENABLE_RELEASES={{ forgejo_config_repository_enable_releases | lower }}

# Rate limiting
FORGEJO__rate_limit__ENABLED={{ forgejo_config_rate_limit_enabled | lower }}
FORGEJO__rate_limit__REQUESTS_PER_HOUR={{ forgejo_config_rate_limit_requests_per_hour }}
FORGEJO__rate_limit__BURST={{ forgejo_config_rate_limit_burst }}

# SSH and Git configuration
{% for key_type, min_size in forgejo_config_ssh_minimum_key_sizes.items() %}
FORGEJO__ssh__MINIMUM_KEY_SIZES_{{ key_type | upper }}={{ min_size }}
{% endfor %}
FORGEJO__ssh__AUTHORIZED_KEYS_BACKUP={{ forgejo_config_ssh_authorized_keys_backup | lower }}
{% if forgejo_config_ssh_authorized_keys_backup %}
FORGEJO__ssh__AUTHORIZED_KEYS_BACKUP_DIR={{ forgejo_config_ssh_authorized_keys_backup_dir }}
{% endif %}

# Git configuration
FORGEJO__git__MAX_GIT_DIFF_LINES={{ forgejo_config_git_max_git_diff_lines }}
FORGEJO__git__MAX_GIT_DIFF_LINE_CHARACTER_COUNT={{ forgejo_config_git_max_git_diff_line_character_count }}
FORGEJO__git__MAX_GIT_DIFF_FILES={{ forgejo_config_git_max_git_diff_files }}

# Notification settings
FORGEJO__notification__ENABLED={{ forgejo_config_notification_enabled | lower }}
FORGEJO__notification__EMAIL_ENABLED={{ forgejo_config_notification_email_enabled | lower }}
FORGEJO__notification__WEBHOOK_ENABLED={{ forgejo_config_notification_webhook_enabled | lower }}
FORGEJO__notification__SLACK_ENABLED={{ forgejo_config_notification_slack_enabled | lower }}
{% if forgejo_config_notification_slack_webhook_url %}
FORGEJO__notification__SLACK_WEBHOOK_URL={{ forgejo_config_notification_slack_webhook_url }}
{% endif %}

# Notification and webhook advanced settings
FORGEJO__notification__WEBHOOK_TIMEOUT={{ forgejo_config_notification_webhook_timeout }}
FORGEJO__notification__WEBHOOK_RETRY_AFTER={{ forgejo_config_notification_webhook_retry_after }}
FORGEJO__notification__WEBHOOK_MAX_DELIVERIES={{ forgejo_config_notification_webhook_max_deliveries }}
FORGEJO__notification__WEBHOOK_SKIP_TLS_VERIFY={{ forgejo_config_notification_webhook_skip_tls_verify | lower }}

# Repository mirror advanced settings
FORGEJO__mirror__CHECK_INTERVAL={{ forgejo_config_mirror_check_interval }}
FORGEJO__mirror__TIMEOUT={{ forgejo_config_mirror_timeout }}
FORGEJO__mirror__SKIP_TLS_VERIFY={{ forgejo_config_mirror_skip_tls_verify | lower }}

# Cron jobs configuration
FORGEJO__cron__ENABLED={{ forgejo_config_cron_enabled | lower }}
FORGEJO__cron__UPDATE_MIRRORS={{ forgejo_config_cron_update_mirrors | lower }}
FORGEJO__cron__REPO_HEALTH_CHECK={{ forgejo_config_cron_repo_health_check | lower }}
FORGEJO__cron__CHECK_REPO_STATS={{ forgejo_config_cron_check_repo_stats | lower }}

# Backup and maintenance settings
FORGEJO__backup__ENABLED={{ forgejo_config_backup_enabled | lower }}
{% if forgejo_config_backup_enabled %}
FORGEJO__backup__PATH={{ forgejo_config_backup_path }}
FORGEJO__backup__RETENTION_DAYS={{ forgejo_config_backup_retention_days }}
FORGEJO__backup__INCLUDE_ATTACHMENTS={{ forgejo_config_backup_include_attachments | lower }}
FORGEJO__backup__INCLUDE_GIT_HOOKS={{ forgejo_config_backup_include_git_hooks | lower }}
FORGEJO__backup__INCLUDE_LFS={{ forgejo_config_backup_include_lfs | lower }}
{% endif %}

# Health check configuration
FORGEJO__health_check__ENABLED={{ forgejo_config_health_check_enabled | lower }}
{% if forgejo_config_health_check_enabled %}
FORGEJO__health_check__PATH={{ forgejo_config_health_check_path }}
FORGEJO__health_check__TIMEOUT={{ forgejo_config_health_check_timeout }}
FORGEJO__health_check__INTERVAL={{ forgejo_config_health_check_interval }}
{% endif %}

# LDAP configuration
FORGEJO__ldap__ENABLED={{ forgejo_config_ldap_enabled | lower }}
{% if forgejo_config_ldap_enabled %}
FORGEJO__ldap__HOST={{ forgejo_config_ldap_host }}
FORGEJO__ldap__PORT={{ forgejo_config_ldap_port }}
{% if forgejo_config_ldap_bind_dn %}
FORGEJO__ldap__BIND_DN={{ forgejo_config_ldap_bind_dn }}
{% endif %}
{% if forgejo_config_ldap_bind_password %}
FORGEJO__ldap__BIND_PASSWORD={{ forgejo_config_ldap_bind_password }}
{% endif %}
{% if forgejo_config_ldap_user_search_base %}
FORGEJO__ldap__USER_SEARCH_BASE={{ forgejo_config_ldap_user_search_base }}
{% endif %}
{% if forgejo_config_ldap_user_filter %}
FORGEJO__ldap__USER_FILTER={{ forgejo_config_ldap_user_filter }}
{% endif %}
{% if forgejo_config_ldap_admin_filter %}
FORGEJO__ldap__ADMIN_FILTER={{ forgejo_config_ldap_admin_filter }}
{% endif %}
{% endif %}

# OAuth configuration
FORGEJO__oauth__ENABLED={{ forgejo_config_oauth_enabled | lower }}
{% if forgejo_config_oauth_enabled and forgejo_config_oauth_providers %}
{% for provider in forgejo_config_oauth_providers %}
FORGEJO__oauth__PROVIDER_{{ provider.name | upper }}_ENABLED={{ provider.enabled | lower }}
FORGEJO__oauth__PROVIDER_{{ provider.name | upper }}_CLIENT_ID={{ provider.client_id }}
FORGEJO__oauth__PROVIDER_{{ provider.name | upper }}_CLIENT_SECRET={{ provider.client_secret }}
{% if provider.auth_url %}
FORGEJO__oauth__PROVIDER_{{ provider.name | upper }}_AUTH_URL={{ provider.auth_url }}
{% endif %}
{% if provider.token_url %}
FORGEJO__oauth__PROVIDER_{{ provider.name | upper }}_TOKEN_URL={{ provider.token_url }}
{% endif %}
{% if provider.profile_url %}
FORGEJO__oauth__PROVIDER_{{ provider.name | upper }}_PROFILE_URL={{ provider.profile_url }}
{% endif %}
{% endfor %}
{% endif %}

{{ forgejo_container_additional_environment_variables }}
